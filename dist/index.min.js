"use strict";var dropZone=document.querySelector(".drop-zone"),fileInput=document.querySelector("#fileInput"),browseBtn=document.querySelector("#browseBtn"),bgProgress=document.querySelector(".bg-progress"),progressPercent=document.querySelector("#progressPercent"),progressContainer=document.querySelector(".progress-container"),progressBar=document.querySelector(".progress-bar"),status=document.querySelector(".status"),sharingContainer=document.querySelector(".sharing-container"),copyURLBtn=document.querySelector("#copyURLBtn"),fileURL=document.querySelector("#fileURL"),emailForm=document.querySelector("#emailForm"),toast=document.querySelector(".toast"),baseURL="https://file-sharing-personal.herokuapp.com",uploadURL="".concat(baseURL,"/api/files"),emailURL="".concat(baseURL,"/api/files/send"),maxAllowedSize=104857600;browseBtn.addEventListener("click",function(){fileInput.click()}),dropZone.addEventListener("drop",function(e){e.preventDefault();var o=e.dataTransfer.files;1===o.length?o[0].size<maxAllowedSize?(fileInput.files=o,uploadFile()):showToast("Max file size is 100MB"):1<o.length&&showToast("You can't upload multiple files"),dropZone.classList.remove("dragged")}),dropZone.addEventListener("dragover",function(e){e.preventDefault(),dropZone.classList.add("dragged")}),dropZone.addEventListener("dragleave",function(e){dropZone.classList.remove("dragged"),console.log("drag ended")}),fileInput.addEventListener("change",function(){if(fileInput.files[0].size>maxAllowedSize)return showToast("Max file size is 100MB"),void(fileInput.value="");uploadFile()}),copyURLBtn.addEventListener("click",function(){fileURL.select(),document.execCommand("copy"),showToast("Copied to clipboard")}),fileURL.addEventListener("click",function(){fileURL.select()});var toastTimer,uploadFile=function(){console.log("file added uploading"),files=fileInput.files;var e=new FormData;e.append("myfile",files[0]),progressContainer.style.display="block";var o=new XMLHttpRequest;o.upload.onprogress=function(e){var o=Math.round(100*e.loaded/e.total);progressPercent.innerText=o;var t="scaleX(".concat(o/100,")");bgProgress.style.transform=t,progressBar.style.transform=t},o.upload.onerror=function(){showToast("Error in upload: ".concat(o.status,".")),fileInput.value=""},o.onreadystatechange=function(){o.readyState==XMLHttpRequest.DONE&&onFileUploadSuccess(o.responseText)},o.open("POST",uploadURL),o.send(e)},onFileUploadSuccess=function(e){fileInput.value="",status.innerText="Uploaded",emailForm[2].removeAttribute("disabled"),emailForm[2].innerText="Send",progressContainer.style.display="none";var o=JSON.parse(e).file;console.log(o),sharingContainer.style.display="block",fileURL.value=o};emailForm.addEventListener("submit",function(e){e.preventDefault(),emailForm[2].setAttribute("disabled","true"),emailForm[2].innerText="Sending";var o={uuid:fileURL.value.split("/").splice(-1,1)[0],emailTo:emailForm.elements["to-email"].value,emailFrom:emailForm.elements["from-email"].value};console.log(o),fetch(emailURL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).then(function(e){return e.json()}).then(function(e){e.success&&(showToast("Email Sent"),sharingContainer.style.display="none")})});var showToast=function(e){clearTimeout(toastTimer),toast.innerText=e,toast.classList.add("show"),toastTimer=setTimeout(function(){toast.classList.remove("show")},2e3)};
//# sourceMappingURL=index.min.js.map
