{"version":3,"sources":["index.js"],"names":["dropZone","document","querySelector","fileInput","browseBtn","bgProgress","progressPercent","progressContainer","progressBar","status","sharingContainer","copyURLBtn","fileURL","emailForm","toast","baseURL","uploadURL","emailURL","maxAllowedSize","addEventListener","click","e","preventDefault","files","dataTransfer","length","size","uploadFile","showToast","classList","remove","add","console","log","value","select","execCommand","formData","FormData","append","style","display","xhr","XMLHttpRequest","upload","onprogress","event","percent","Math","round","loaded","total","innerText","scaleX","transform","onerror","onreadystatechange","readyState","DONE","onFileUploadSuccess","responseText","open","send","res","removeAttribute","JSON","parse","url","file","setAttribute","uuid","split","splice","emailTo","elements","emailFrom","fetch","method","headers","body","stringify","then","json","data","success","toastTimer","msg","clearTimeout","setTimeout"],"mappings":"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","sourcesContent":["const dropZone = document.querySelector(\".drop-zone\");\r\nconst fileInput = document.querySelector(\"#fileInput\");\r\nconst browseBtn = document.querySelector(\"#browseBtn\");\r\n\r\nconst bgProgress = document.querySelector(\".bg-progress\");\r\nconst progressPercent = document.querySelector(\"#progressPercent\");\r\nconst progressContainer = document.querySelector(\".progress-container\");\r\nconst progressBar = document.querySelector(\".progress-bar\");\r\nconst status = document.querySelector(\".status\");\r\n\r\nconst sharingContainer = document.querySelector(\".sharing-container\");\r\nconst copyURLBtn = document.querySelector(\"#copyURLBtn\");\r\nconst fileURL = document.querySelector(\"#fileURL\");\r\nconst emailForm = document.querySelector(\"#emailForm\");\r\n\r\nconst toast = document.querySelector(\".toast\");\r\n\r\nconst baseURL = \"https://file-sharing-personal.herokuapp.com\";\r\nconst uploadURL = `${baseURL}/api/files`;\r\nconst emailURL = `${baseURL}/api/files/send`;\r\n\r\nconst maxAllowedSize = 100 * 1024 * 1024; //100mb\r\n\r\n\r\nbrowseBtn.addEventListener(\"click\", () => {\r\n  fileInput.click();\r\n});\r\n\r\ndropZone.addEventListener(\"drop\", (e) => {\r\n  e.preventDefault();\r\n  //   console.log(\"dropped\", e.dataTransfer.files[0].name);\r\n  const files = e.dataTransfer.files;\r\n  if (files.length === 1) {\r\n    if (files[0].size < maxAllowedSize) {\r\n      fileInput.files = files;\r\n      uploadFile();\r\n    } else {\r\n      showToast(\"Max file size is 100MB\");\r\n    }\r\n  } else if (files.length > 1) {\r\n    showToast(\"You can't upload multiple files\");\r\n  }\r\n  dropZone.classList.remove(\"dragged\");\r\n});\r\n\r\ndropZone.addEventListener(\"dragover\", (e) => {\r\n  e.preventDefault();\r\n  dropZone.classList.add(\"dragged\");\r\n\r\n  // console.log(\"dropping file\");\r\n});\r\n\r\ndropZone.addEventListener(\"dragleave\", (e) => {\r\n  dropZone.classList.remove(\"dragged\");\r\n\r\n  console.log(\"drag ended\");\r\n});\r\n\r\n// file input change and uploader\r\nfileInput.addEventListener(\"change\", () => {\r\n  if (fileInput.files[0].size > maxAllowedSize) {\r\n    showToast(\"Max file size is 100MB\");\r\n    fileInput.value = \"\"; // reset the input\r\n    return;\r\n  }\r\n  uploadFile();\r\n});\r\n\r\n// sharing container listenrs\r\ncopyURLBtn.addEventListener(\"click\", () => {\r\n  fileURL.select();\r\n  document.execCommand(\"copy\");\r\n  showToast(\"Copied to clipboard\");\r\n});\r\n\r\nfileURL.addEventListener(\"click\", () => {\r\n  fileURL.select();\r\n});\r\n\r\nconst uploadFile = () => {\r\n  console.log(\"file added uploading\");\r\n\r\n  files = fileInput.files;\r\n  const formData = new FormData();\r\n  formData.append(\"myfile\", files[0]);\r\n\r\n  //show the uploader\r\n  progressContainer.style.display = \"block\";\r\n\r\n  // upload file\r\n  const xhr = new XMLHttpRequest();\r\n\r\n  // listen for upload progress\r\n  xhr.upload.onprogress = function (event) {\r\n    // find the percentage of uploaded\r\n    let percent = Math.round((100 * event.loaded) / event.total);\r\n    progressPercent.innerText = percent;\r\n    const scaleX = `scaleX(${percent / 100})`;\r\n    bgProgress.style.transform = scaleX;\r\n    progressBar.style.transform = scaleX;\r\n  };\r\n\r\n  // handle error\r\n  xhr.upload.onerror = function () {\r\n    showToast(`Error in upload: ${xhr.status}.`);\r\n    fileInput.value = \"\"; // reset the input\r\n  };\r\n\r\n  // listen for response which will give the link\r\n  xhr.onreadystatechange = function () {\r\n    if (xhr.readyState == XMLHttpRequest.DONE) {\r\n      onFileUploadSuccess(xhr.responseText);\r\n    }\r\n  };\r\n\r\n  xhr.open(\"POST\", uploadURL);\r\n  xhr.send(formData);\r\n};\r\n\r\nconst onFileUploadSuccess = (res) => {\r\n  fileInput.value = \"\"; // reset the input\r\n  status.innerText = \"Uploaded\";\r\n\r\n  // remove the disabled attribute from form btn & make text send\r\n  emailForm[2].removeAttribute(\"disabled\");\r\n  emailForm[2].innerText = \"Send\";\r\n  progressContainer.style.display = \"none\"; // hide the box\r\n\r\n  const { file: url } = JSON.parse(res);\r\n  console.log(url);\r\n  sharingContainer.style.display = \"block\";\r\n  fileURL.value = url;\r\n};\r\n\r\nemailForm.addEventListener(\"submit\", (e) => {\r\n  e.preventDefault(); // stop submission\r\n\r\n  // disable the button\r\n  emailForm[2].setAttribute(\"disabled\", \"true\");\r\n  emailForm[2].innerText = \"Sending\";\r\n\r\n  const url = fileURL.value;\r\n\r\n  const formData = {\r\n    uuid: url.split(\"/\").splice(-1, 1)[0],\r\n    emailTo: emailForm.elements[\"to-email\"].value,\r\n    emailFrom: emailForm.elements[\"from-email\"].value,\r\n  };\r\n  console.log(formData);\r\n  fetch(emailURL, {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n    body: JSON.stringify(formData),\r\n  })\r\n    .then((res) => res.json())\r\n    .then((data) => {\r\n      if (data.success) {\r\n        showToast(\"Email Sent\");\r\n        sharingContainer.style.display = \"none\"; // hide the box\r\n      }\r\n    });\r\n});\r\n\r\nlet toastTimer;\r\n// the toast function\r\nconst showToast = (msg) => {\r\n  clearTimeout(toastTimer);\r\n  toast.innerText = msg;\r\n  toast.classList.add(\"show\");\r\n  toastTimer = setTimeout(() => {\r\n    toast.classList.remove(\"show\");\r\n  }, 2000);\r\n};"],"file":"index.dev.js"}